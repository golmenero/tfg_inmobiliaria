{% extends "../base.html" %} {% block titulo %} ARCA Inmobiliaria {% endblock %}

{% block contenido_principal %}
<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/">Inicio</a></li>
        <li class="breadcrumb-item active" aria-current="page">Conversaciones</li>
    </ol>
</nav>
<div class="container">
    <h2 class="sectionHeader">Conversaciones Activas</h2>

    <div class="div-field table-responsive">
        <table class="table table-hover">
            <thead class="thead-dark">
            <tr>
                <th scope="col-md-3"></th>
                {% if user.permission == 'U'%}
                <th scope="col-md-3">Nombre</th>
                <th scope="col-md-2">Tipo</th>
                <th scope="col-md-2">Precio</th>
                {% else %}
                <th scope="col-md-3">Usuario</th>
                <th scope="col-md-2">Nombre</th>
                <th scope="col-md-1">Tipo</th>
                <th scope="col-md-1">Precio</th>
                {% endif %}
                <th scope="col-md-1">Propiedad</th>
                <th scope="col-md-1">Acceso</th>
            </tr>
            </thead>
            <tbody>
            {% for conversation in conversations %}
            <tr>
                <td><img class='img-table'
                         src="propertiesimg/{{ conversation.property._id.toString()}}/{{ conversation.property._id.toString()}}_0.png"
                         alt="Imagen de Propiedad"/></td>

                {% if user.permission != 'U'%}
                <td>{{conversation.user.name}}  {{conversation.user.surname}} - {{conversation.user.email}}</td>
                {% endif %}
                <td>
                    {% if conversation.unseenCount > 0 %}
                    <span id="notificationsBadge{{conversation._id}}" class="badge badge-danger">{{conversation.unseenCount}}</span>
                    {% endif %}
                    {{conversation.property.name }}
                </td>
                <td>{{ conversation.property.type }}</td>
                <td>{{ conversation.property.price }}</td>
                <td>
                    <a class="btn btn-dark"
                       href="/properties/details/{{conversation.property._id.toString() }}">Ver propiedad</span></a>
                </td>
                <td>
                    <a class="btn btn-success"
                       href="/conversations/chat/{{ conversation._id.toString() }}">Acceso</span></a>
                </td>
            </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
